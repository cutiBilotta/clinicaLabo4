"use strict";(self.webpackChunkclinica=self.webpackChunkclinica||[]).push([[276],{5276:(E,u,r)=>{r.r(u),r.d(u,{MisTurnosModule:()=>w});var l=r(6814),d=r(1826),t=r(5879),p=r(6751),_=r(4108);function h(e,s){if(1&e&&(t.TgZ(0,"th",10),t._uU(1),t.qZA()),2&e){const i=s.$implicit;t.xp6(1),t.Oqu(i)}}function f(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"td",13),t.NdJ("click",function(){t.CHM(i);const n=t.oxw().$implicit,a=t.oxw();return t.KtG(a.seleccionarTurno(n))}),t._uU(1),t.qZA()}if(2&e){const i=s.$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(o[i])}}function m(e,s){if(1&e&&(t.TgZ(0,"tr")(1,"th",11),t._uU(2),t.qZA(),t.YNc(3,f,2,1,"td",12),t.qZA()),2&e){const i=s.index,o=t.oxw();t.xp6(2),t.Oqu(i+1),t.xp6(1),t.Q6J("ngForOf",o.turnosKeys)}}function g(e,s){if(1&e&&(t.TgZ(0,"p",23)(1,"b"),t._uU(2),t.qZA()()),2&e){const i=t.oxw(2);t.xp6(2),t.Oqu(i.mensajeError)}}function T(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(i),t.oxw();const n=t.MAs(6),a=t.oxw();return t.KtG(a.cancelarTurno(n.value))}),t._uU(1,"Cancelar"),t.qZA()}}function b(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(2);return t.KtG(n.aceptarTurno())}),t._uU(1,"Aceptar"),t.qZA()}}function x(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(i),t.oxw();const n=t.MAs(6),a=t.MAs(12),c=t.oxw();return t.KtG(c.finalizarTurno(n.value,a.value))}),t._uU(1,"Finalizar"),t.qZA()}}function Z(e,s){if(1&e){const i=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(i),t.oxw();const n=t.MAs(6),a=t.oxw();return t.KtG(a.rechazarTurno(n.value))}),t._uU(1,"Rechazar"),t.qZA()}}function v(e,s){if(1&e&&(t.TgZ(0,"div")(1,"div",14)(2,"div",15)(3,"span",16),t._uU(4,"Rese\xf1a "),t.qZA()(),t._UZ(5,"input",17,18),t.qZA(),t.TgZ(7,"div",14)(8,"div",15)(9,"span",19),t._uU(10,"Diagn\xf3stico "),t.qZA()(),t._UZ(11,"input",17,20),t.qZA(),t.YNc(13,g,3,1,"p",21),t.YNc(14,T,2,0,"button",22),t.YNc(15,b,2,0,"button",22),t.YNc(16,x,2,0,"button",22),t.YNc(17,Z,2,0,"button",22),t.qZA()),2&e){const i=t.oxw();t.xp6(13),t.Q6J("ngIf",""!=i.mensajeError),t.xp6(1),t.Q6J("ngIf","solicitado"==i.turnoSeleccionado.estado),t.xp6(1),t.Q6J("ngIf","solicitado"==i.turnoSeleccionado.estado),t.xp6(1),t.Q6J("ngIf","aceptado"==i.turnoSeleccionado.estado.toLowerCase()),t.xp6(1),t.Q6J("ngIf","solicitado"==i.turnoSeleccionado.estado)}}function C(e,s){if(1&e&&(t.TgZ(0,"div")(1,"p"),t._uU(2),t.TgZ(3,"b",23),t._uU(4),t.qZA()()()),2&e){const i=s.$implicit;t.xp6(2),t.hij("ID Turno: ",i.id," - "),t.xp6(2),t.hij("Comentario: ",i.resenia,"")}}function A(e,s){if(1&e&&(t.TgZ(0,"div")(1,"h4",8),t._uU(2,"Turnos Cancelados: "),t.qZA(),t.YNc(3,C,5,2,"div",5),t.qZA()),2&e){const i=t.oxw();t.xp6(3),t.Q6J("ngForOf",i.resenias)}}function M(e,s){if(1&e){const i=t.EpF();t.ynx(0),t.TgZ(1,"input",28),t.NdJ("change",function(){const a=t.CHM(i).$implicit,c=t.oxw(3);return t.KtG(c.filtrarTablaEspecialidad(a))}),t.qZA(),t._uU(2),t._UZ(3,"br"),t.BQk()}if(2&e){const i=s.$implicit;t.xp6(1),t.Q6J("value",i),t.xp6(1),t.hij(" ",i,"")}}function F(e,s){if(1&e&&(t.ynx(0),t.YNc(1,M,4,2,"ng-container",5),t.BQk()),2&e){const i=s.$implicit;t.xp6(1),t.Q6J("ngForOf",i.especialidades)}}function I(e,s){if(1&e&&(t.TgZ(0,"div",25)(1,"h5",26),t._uU(2,"Especialidad"),t.qZA(),t.TgZ(3,"div",27),t.YNc(4,F,2,1,"ng-container",5),t.qZA()()),2&e){const i=t.oxw();t.xp6(4),t.Q6J("ngForOf",i.especialidades)}}function y(e,s){if(1&e){const i=t.EpF();t.ynx(0),t.TgZ(1,"input",31),t.NdJ("change",function(){const a=t.CHM(i).$implicit,c=t.oxw(2);return t.KtG(c.filtrarTablaEspecialista(a.id))}),t.qZA(),t._uU(2),t._UZ(3,"br"),t.BQk()}if(2&e){const i=s.$implicit;t.xp6(1),t.Q6J("value",i),t.xp6(1),t.lnq("",i.nombre," ",i.apellido," - ",i.id,"")}}function S(e,s){if(1&e&&(t.TgZ(0,"div",25)(1,"h5",29),t._uU(2,"Especialista"),t.qZA(),t.TgZ(3,"div",30),t.YNc(4,y,4,4,"ng-container",5),t.qZA()()),2&e){const i=t.oxw();t.xp6(4),t.Q6J("ngForOf",i.especialistas)}}function q(e,s){if(1&e){const i=t.EpF();t.ynx(0),t.TgZ(1,"input",34),t.NdJ("change",function(){const a=t.CHM(i).$implicit,c=t.oxw(2);return t.KtG(c.filtrarTablaPacientes(a.id))}),t.qZA(),t._uU(2),t._UZ(3,"br"),t.BQk()}if(2&e){const i=s.$implicit;t.xp6(1),t.Q6J("value",i),t.xp6(1),t.AsE("",i.nombre," ",i.apellido,"")}}function U(e,s){if(1&e&&(t.TgZ(0,"div",25)(1,"h5",32),t._uU(2,"Pacientes"),t.qZA(),t.TgZ(3,"div",33),t.YNc(4,q,4,3,"ng-container",5),t.qZA()()),2&e){const i=t.oxw();t.xp6(4),t.Q6J("ngForOf",i.pacientes)}}const k=[{path:"",component:(()=>{class e{constructor(i,o){this.database=i,this.afauth=o,this.turnos=[],this.usuarios=[],this.especialistas=[],this.esPaciente=!1,this.pacientes=[],this.turnosKeys=[],this.tablaFiltrada=[],this.mensajeError="",this.especialidades=[],this.resenias=[],this.mostrarBotonCancelar=!1,this.mostrarDivDiagnostico=!1}ngOnInit(){this.afauth.getAuthState().subscribe(i=>{if(i){const o=i.email?.toString();console.log(o),this.database.obtenerTodos("usuarios").subscribe(n=>{this.usuarios=n.map(a=>{let c=a.payload.doc.data();return c.id=a.payload.doc.id,c}),this.especialistas=this.usuarios.filter(a=>"Especialista"==a.perfil),this.pacientes=this.usuarios.filter(a=>"Paciente"==a.perfil),this.usuarioActualBd=this.usuarios.find(a=>a.email==o),this.usuarioActualId=this.usuarioActualBd.id,console.log(this.usuarioActualId),this.esPaciente=!!this.usuarioActualBd&&"paciente"==this.usuarioActualBd.perfil.toLowerCase(),console.log("Es Paciente : "+this.esPaciente),console.log(this.usuarios),console.log(this.pacientes)})}}),this.database.obtenerTodos("especialidades").subscribe(i=>{this.especialidades=i.map(o=>{let n=o.payload.doc.data();return n.id=o.payload.doc.id,n})}),this.database.obtenerTodos("turnos").subscribe(i=>{this.turnos=i.map(o=>{let n=o.payload.doc.data();return n.id=o.payload.doc.id,n}),this.turnos.forEach(o=>{this.turnosKeys=Object.keys(o),null!=o.rese\u00f1aCancelacion&&this.resenias.push({id:o.id,resenia:o.rese\u00f1aCancelacion})}),console.log(this.turnos),this.filtrarTurnos()})}filtrarTurnos(){this.esPaciente?(console.log(this.usuarioActualId),this.tablaFiltrada=this.turnos.filter(i=>i.pacienteId==this.usuarioActualId)):this.tablaFiltrada=this.turnos.filter(i=>i.especialistaId==this.usuarioActualId)}filtrarTablaEspecialidad(i){const o=i;console.log(o),this.tablaFiltrada=this.turnos.filter(this.esPaciente?n=>n.especialidad==o&&n.pacienteId==this.usuarioActualId:n=>n.especialidad==o&&n.especialistaId==this.usuarioActualId)}filtrarTablaEspecialista(i){const o=i;console.log(o),this.tablaFiltrada=this.turnos.filter(this.esPaciente?n=>n.especialistaId==o&&n.pacienteId==this.usuarioActualId:n=>n.especialistaId==o)}filtrarTablaPacientes(i){const o=i;console.log(o),this.tablaFiltrada=this.turnos.filter(this.esPaciente?n=>n.pacienteId==o:n=>n.pacienteId==o&&n.especialistaId==this.usuarioActualId)}seleccionarTurno(i){this.turnoSeleccionado=i,console.log(i.id),"realizado"!=i.estado.toLowerCase()&&"cancelado"!=i.estado.toLowerCase()&&(this.mostrarBotonCancelar=!0)}cancelarTurno(i){""!==i.trim()&&"solicitado"==this.turnoSeleccionado.estado.toLowerCase()?(this.turnoSeleccionado.estado="Cancelado",this.turnoSeleccionado.rese\u00f1aCancelacion=i,this.database.actualizar("turnos",this.turnoSeleccionado,this.turnoSeleccionado.id)):this.mensajeError="El campo de rese\xf1a por cancelaci\xf3n no puede estar vac\xedo",this.resenias=[]}aceptarTurno(){"solicitado"==this.turnoSeleccionado.estado.toLowerCase()&&(this.turnoSeleccionado.estado="Aceptado",this.database.actualizar("turnos",this.turnoSeleccionado,this.turnoSeleccionado.id)),this.resenias=[]}rechazarTurno(i){""!==i.trim()?(this.turnoSeleccionado.estado="Rechazado",this.turnoSeleccionado.rese\u00f1aCancelacion=i,this.database.actualizar("turnos",this.turnoSeleccionado,this.turnoSeleccionado.id)):this.mensajeError="El campo de rese\xf1a por cancelaci\xf3n no puede estar vac\xedo",this.resenias=[]}finalizarTurno(i,o){this.mostrarDivDiagnostico=!0,""!==i.trim()&&""!==o.trim()&&"aceptado"==this.turnoSeleccionado.estado.toLowerCase()?(this.turnoSeleccionado.estado="Finalizado",this.turnoSeleccionado.rese\u00f1a=i,this.turnoSeleccionado.diagnostico=o,this.database.actualizar("turnos",this.turnoSeleccionado,this.turnoSeleccionado.id)):this.mensajeError="El campo de rese\xf1a y diagnostico no puede estar vac\xedo",this.resenias=[]}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(p.T),t.Y36(_.e))};static#i=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-mis-turnos"]],decls:27,vars:7,consts:[[1,"container"],[1,"text-center","text-dark"],[1,"table","table-bordered","table-light"],["scope","col",2,"background-color","#49708a"],["style","background-color: #caff42;","scope","col",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"row","justify-content-center"],[1,"text-center"],["class","form-group col-4",4,"ngIf"],["scope","col",2,"background-color","#caff42"],["scope","row"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"input-group","input-group-sm","mb-3"],[1,"input-group-prepend"],["id","rese\xf1a",1,"input-group-text",2,"background-color","#ddd"],["type","text","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control"],["reseniaInput",""],["id","diagnostico",1,"input-group-text",2,"background-color","#ddd"],["diagnosticoInput",""],["class","text-danger",4,"ngIf"],["class","btn mx-2","style","background-color: #caff42;",3,"click",4,"ngIf"],[1,"text-danger"],[1,"btn","mx-2",2,"background-color","#caff42",3,"click"],[1,"form-group","col-4"],["for","especialidad"],["multiple","","id","especialidad",1,"form-control",2,"background-color","#88abc2"],["type","radio","name","especialidadSeleccionada",3,"value","change"],["for","especialista"],["id","especialista",1,"form-control",2,"background-color","#88abc2"],["type","radio","name","especialista",3,"value","change"],["for","pacientes"],["id","pacientes",1,"form-control",2,"background-color","#88abc2"],["type","radio","name","pacientes",3,"value","change"]],template:function(o,n){1&o&&(t.TgZ(0,"body")(1,"div",0),t._UZ(2,"br")(3,"br"),t.TgZ(4,"h3",1),t._uU(5,"Tus Turnos"),t.qZA(),t._UZ(6,"br"),t.TgZ(7,"table",2)(8,"thead")(9,"tr")(10,"th",3),t._uU(11,"#"),t.qZA(),t.YNc(12,h,2,1,"th",4),t.qZA()(),t.TgZ(13,"tbody"),t.YNc(14,m,4,2,"tr",5),t.qZA()(),t.YNc(15,v,18,5,"div",6),t._UZ(16,"hr"),t.YNc(17,A,4,1,"div",6),t._UZ(18,"br"),t.TgZ(19,"div",7)(20,"h4",8),t._uU(21,"Filtrar tablas "),t.qZA(),t.YNc(22,I,5,1,"div",9),t.YNc(23,S,5,1,"div",9),t.YNc(24,U,5,1,"div",9),t.qZA(),t._UZ(25,"br")(26,"br"),t.qZA()()),2&o&&(t.xp6(12),t.Q6J("ngForOf",n.turnosKeys),t.xp6(2),t.Q6J("ngForOf",n.tablaFiltrada),t.xp6(1),t.Q6J("ngIf",n.mostrarBotonCancelar),t.xp6(2),t.Q6J("ngIf",n.esPaciente&&null!=n.resenias&&n.resenias.length>0),t.xp6(5),t.Q6J("ngIf",null!=n.especialidades&&n.especialidades.length>0),t.xp6(1),t.Q6J("ngIf",n.esPaciente&&null!=n.especialistas&&n.especialistas.length>0),t.xp6(1),t.Q6J("ngIf",!n.esPaciente&&null!=n.especialistas&&n.especialistas.length>0))},dependencies:[l.sg,l.O5],styles:["body[_ngcontent-%COMP%]{background-color:#d0e0eb;width:100vw;height:100vh}"]})}return e})()}];let J=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#i=this.\u0275mod=t.oAB({type:e});static#e=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(k),d.Bz]})}return e})(),w=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#i=this.\u0275mod=t.oAB({type:e});static#e=this.\u0275inj=t.cJS({imports:[l.ez,J]})}return e})()}}]);