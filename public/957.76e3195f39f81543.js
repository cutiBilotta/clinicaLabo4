"use strict";(self.webpackChunkclinica=self.webpackChunkclinica||[]).push([[957],{2957:(I,h,r)=>{r.r(h),r.d(h,{CargaHistClinicaModule:()=>N});var g=r(6814),u=r(1826),m=r(5861),C=r(3519),b=r.n(C),i=r(5879),_=r(6751),Z=r(4108),T=r(6700),v=r(7045),d=r(95);function y(o,l){if(1&o){const e=i.EpF();i.TgZ(0,"div",25)(1,"div",26)(2,"label",27)(3,"b"),i._uU(4),i.qZA()()(),i.TgZ(5,"div",28)(6,"button",29),i.NdJ("click",function(){const n=i.CHM(e).$implicit,s=i.oxw();return i.KtG(s.seleccionarPaciente(n))}),i._UZ(7,"img",30),i.qZA()()()}if(2&o){const e=l.$implicit;i.xp6(4),i.AsE(" ",e.nombre," ",e.apellido," "),i.xp6(3),i.s9C("src",e.imagenURL,i.LSH)}}function x(o,l){if(1&o&&(i.TgZ(0,"h4"),i._uU(1),i.qZA()),2&o){const e=l.$implicit;i.xp6(1),i.HOy(" ",e.especialidad," - ",e.dia," ",e.horario," - DX: ",e.diagnostico," ")}}function M(o,l){if(1&o&&(i.TgZ(0,"div",31),i._UZ(1,"br"),i.TgZ(2,"h3",32)(3,"b"),i._uU(4),i.qZA()(),i.TgZ(5,"h3",33)(6,"b"),i._uU(7,"Turnos finalizados"),i.qZA()(),i.YNc(8,x,2,4,"h4",34),i._UZ(9,"br"),i.qZA()),2&o){const e=i.oxw();i.xp6(4),i.AsE(" Paciente Seleccionado: ",e.pacienteSeleccionado.nombre," ",e.pacienteSeleccionado.apellido,""),i.xp6(4),i.Q6J("ngForOf",e.turnosDelPaciente)}}function A(o,l){1&o&&i._UZ(0,"img",36)}const H=function(){return[]};function U(o,l){if(1&o&&(i.TgZ(0,"h4"),i._uU(1),i.YNc(2,A,1,0,"img",35),i.qZA()),2&o){const e=l.$implicit;i.xp6(1),i.hij(" ",e.comentario," - "),i.xp6(1),i.Q6J("ngForOf",i.DdM(2,H).constructor(e.calificacion))}}function F(o,l){if(1&o&&(i.TgZ(0,"div",31)(1,"h3",33)(2,"b"),i._uU(3,"Calificaciones"),i.qZA()(),i.YNc(4,U,3,3,"h4",34),i._UZ(5,"br"),i.qZA()),2&o){const e=i.oxw();i.xp6(4),i.Q6J("ngForOf",e.calificacionesFiltradas)}}function J(o,l){if(1&o){const e=i.EpF();i.TgZ(0,"div",20),i._UZ(1,"hr"),i.TgZ(2,"div",11)(3,"div",12)(4,"span",13)(5,"b"),i._uU(6,"Dato"),i.qZA()()(),i.TgZ(7,"input",37),i.NdJ("ngModelChange",function(t){i.CHM(e);const n=i.oxw();return i.KtG(n.datoDos=t)}),i.qZA(),i.TgZ(8,"div",12)(9,"span",13)(10,"b"),i._uU(11,"Descripcion"),i.qZA()()(),i.TgZ(12,"input",38),i.NdJ("ngModelChange",function(t){i.CHM(e);const n=i.oxw();return i.KtG(n.descDos=t)}),i.qZA()()()}if(2&o){const e=i.oxw();i.xp6(7),i.Q6J("ngModel",e.datoDos),i.xp6(5),i.Q6J("ngModel",e.descDos)}}function D(o,l){if(1&o){const e=i.EpF();i.TgZ(0,"div",20),i._UZ(1,"hr"),i.TgZ(2,"div",11)(3,"div",12)(4,"span",13)(5,"b"),i._uU(6,"Dato"),i.qZA()()(),i.TgZ(7,"input",39),i.NdJ("ngModelChange",function(t){i.CHM(e);const n=i.oxw();return i.KtG(n.datoTres=t)}),i.qZA(),i.TgZ(8,"div",12)(9,"span",13)(10,"b"),i._uU(11,"Descripcion"),i.qZA()()(),i.TgZ(12,"input",40),i.NdJ("ngModelChange",function(t){i.CHM(e);const n=i.oxw();return i.KtG(n.descTres=t)}),i.qZA()()()}if(2&o){const e=i.oxw();i.xp6(7),i.Q6J("ngModel",e.datoTres),i.xp6(5),i.Q6J("ngModel",e.descTres)}}function E(o,l){if(1&o){const e=i.EpF();i.TgZ(0,"div",41)(1,"button",42),i.NdJ("click",function(){i.CHM(e);const t=i.oxw();return i.KtG(t.enviarHistoriaClinica())}),i._uU(2,"Enviar Historia Clinica"),i.qZA()()}}const S=[{path:"",component:(()=>{class o{constructor(e,a,t,n){this.database=e,this.afauth=a,this.router=t,this.storageService=n,this.usuarios=[],this.especialistas=[],this.pacientes=[],this.turnos=[],this.turnosFiltrados=[],this.turnosKeys=[],this.calificaciones=[],this.calificacionesFiltradas=[],this.pacientesFiltrados=[],this.camposVisibles=1,this.mensajeError="",this.mensajeErrorHist="",this.pacientesConImg=[],this.turnosDelPaciente=[],this.puntuacion=[]}ngOnInit(){var e=this;this.afauth.getAuthState().subscribe(a=>{if(a){const t=a.email?.toString();console.log(t),this.database.obtenerTodos("usuarios").subscribe(function(){var n=(0,m.Z)(function*(s){e.usuarios=s.map(c=>{let p=c.payload.doc.data();return p.id=c.payload.doc.id,p}),e.especialistas=e.usuarios.filter(c=>"especialista"==c.perfil.toLocaleLowerCase()),e.pacientes=e.usuarios.filter(c=>"paciente"==c.perfil.toLocaleLowerCase()),e.usuarioActualBd=e.usuarios.find(c=>c.email==t)});return function(s){return n.apply(this,arguments)}}())}this.database.obtenerTodos("turnos").subscribe(t=>{this.turnos=t.map(n=>{let s=n.payload.doc.data();return s.id=n.payload.doc.id,s}),this.turnos.forEach(n=>{n.especialistaId==this.usuarioActualBd.id&&"finalizado"==n.estado.toLowerCase()&&this.turnosFiltrados.push(n)}),0==this.turnosKeys.length&&this.turnosKeys.push("especialidad","dia","horario","nombre","apellido"),this.turnosFiltrados.forEach(n=>{const s=n.pacienteId,c=this.usuarios.find(p=>p.id===s);c&&!this.pacientesFiltrados.includes(c)&&this.pacientesFiltrados.push(c)}),console.log(this.pacientesFiltrados),console.log(this.turnosFiltrados),this.obtenerPacientesFiltradosConImagen()}),this.database.obtenerTodos("calificaciones").subscribe(t=>{this.calificaciones=t.map(n=>{let s=n.payload.doc.data();return s.id=n.payload.doc.id,s})})})}obtenerPacientesFiltradosConImagen(){var e=this;return(0,m.Z)(function*(){for(const a of e.pacientesFiltrados)if(a.imgPerfil&&a.imgPerfil.length>0){const t=a.imgPerfil[0],n=yield e.storageService.obtenerImagen("users",t);a.imagenURL=n}e.pacientesConImg=e.pacientesFiltrados.map(a=>({nombre:a.nombre,apellido:a.apellido,email:a.email,edad:a.edad,obra_social:a.obra_social,perfil:a.perfil,password:a.password,imagenURL:a.imagenURL,id:a.id})).filter(a=>null!==a)})()}seleccionarPaciente(e){this.turnosDelPaciente=[],this.pacienteSeleccionado=e,this.calificacionesFiltradas=[],this.turnosDelPaciente=this.turnosFiltrados.filter(a=>a.pacienteId==this.pacienteSeleccionado.id),this.calificacionesFiltradas=this.calificaciones.filter(a=>a.pacienteId==this.pacienteSeleccionado.id),this.calificacionesFiltradas.forEach(a=>{a.calificacion=parseInt(a.calificacion,10)}),console.log(this.calificacionesFiltradas)}enviarHistoriaClinica(){if(!(this.altura&&this.peso&&this.temperatura&&this.presion))return void(this.mensajeError="Todos los campos son obligatorios");if(this.altura<=30||this.altura>=250)return void(this.mensajeError="La altura debe estar entre 30 y 250 cent\xedmetros");if(this.peso<=1||this.peso>=300)return void(this.mensajeError="El peso debe estar entre 1 y 300 gramos");if(isNaN(this.temperatura)||this.temperatura<=30||this.temperatura>=45)return void(this.mensajeError="La temperatura debe ser un n\xfamero v\xe1lido y estar entre 30 y 45 grados.");if(this.camposVisibles>=1&&(!this.datoUno||!this.descUno))return void(this.mensajeError="Los campos Dato y Descripci\xf3n son obligatorios.");if(this.camposVisibles>=2&&(!this.datoDos||!this.descDos))return void(this.mensajeError="Los campos Dato y Descripci\xf3n son obligatorios.");if(!(3!==this.camposVisibles||this.datoTres&&this.descTres))return void(this.mensajeError="Los campos Dato y Descripci\xf3n son obligatorios.");if(this.camposVisibles>=1&&!/^[a-zA-Z\s]+$/.test(this.datoUno))return void(this.mensajeErrorHist="El campo Dato solo puede contener letras y espacios.");if(this.camposVisibles>=2&&!/^[a-zA-Z\s]+$/.test(this.datoDos))return void(this.mensajeErrorHist="El campo Dato solo puede contener letras y espacios.");if(3===this.camposVisibles&&!/^[a-zA-Z\s]+$/.test(this.datoTres))return void(this.mensajeErrorHist="El campo Dato solo puede contener letras y espacios.");const e=this.presion.split("/");if(2!==e.length||isNaN(+e[0])||isNaN(+e[1])||+e[0]<10||+e[0]>300||+e[1]<10||+e[1]>300)return void(this.mensajeError="El formato de presi\xf3n no es v\xe1lido. Debe ser XX/YY donde ambos n\xfameros est\xe1n entre 10 y 300");const n=[];n.push({dato:this.datoUno,descripcion:this.descUno}),this.camposVisibles>=2&&this.datoDos&&this.descDos&&n.push({dato:this.datoDos,descripcion:this.descDos}),3===this.camposVisibles&&this.datoTres&&this.descTres&&n.push({dato:this.datoTres,descripcion:this.descTres});const s={presion:this.presion,altura:this.altura,peso:this.peso,temperatura:this.temperatura,detalles:n};this.pacienteSeleccionado.hasOwnProperty("historiaClinica")||(this.pacienteSeleccionado.historiaClinica=[]),this.pacienteSeleccionado.historiaClinica.push(s),console.log("Paciente con historia cl\xednica:",this.pacienteSeleccionado),this.database.actualizar("usuarios",this.pacienteSeleccionado,this.pacienteSeleccionado.id),b().fire({title:"Historia Clinica cargada con \xe9xito",confirmButtonColor:"#caff42",confirmButtonText:"Entendido"}).then(()=>{this.router.navigateByUrl("/home")})}agregarCampo(){this.camposVisibles<3&&this.camposVisibles++}eliminarCampo(){this.camposVisibles>1&&this.camposVisibles--}static#i=this.\u0275fac=function(a){return new(a||o)(i.Y36(_.T),i.Y36(Z.e),i.Y36(u.F0),i.Y36(T.V))};static#e=this.\u0275cmp=i.Xpm({type:o,selectors:[["app-carga-hist-clinica"]],decls:66,vars:16,consts:[[1,"container"],[1,"text-center","text-dark","my-3"],[1,"my-5",2,"text-align","center"],["class","col-3","style","display: inline-block; ",4,"ngFor","ngForOf"],[1,"my-3",2,"background-color","#eee"],["class","my-3 mx-3 ",4,"ngIf"],["class","my-3 mx-3",4,"ngIf"],[1,"px-3","py-3",2,"background-color","#ddd"],[1,"text-center"],[1,"text-danger"],[1,"px-5","py-5",2,"background-color","#bbb"],[1,"input-group","input-group-sm","mb-3"],[1,"input-group-prepend"],["id","rese\xf1a",1,"input-group-text",2,"background-color","#88abc2"],["type","text","placeholder","altura","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control","pr-5",3,"ngModel","ngModelChange"],["type","text","placeholder","peso","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","temperatura","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","presion","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn-sm","btn-success","mx-3","mb-3",3,"disabled","click"],[1,"btn","btn-sm","btn-danger","mb-3",3,"disabled","click"],[1,"px-3","py-3",2,"background-color","#bbb"],["type","text","placeholder","caries","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","4","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],["style","background-color: #bbb;","class","px-3 py-3",4,"ngIf"],["class","mt-3 mb-5","style","text-align: center;",4,"ngIf"],[1,"col-3",2,"display","inline-block"],[1,"row"],["for",""],["clas","row"],[1,"btn",2,"background-color","#88abc2","border-radius","50%","height","130px","width","130px",3,"click"],["alt","",2,"border-radius","50%","height","100px","width","100px",3,"src"],[1,"my-3","mx-3"],[1,"text-primary","text-center"],[1,"text-primary"],[4,"ngFor","ngForOf"],["style","height: 30px; width: 30px;","src","../../../../assets/img/full-star.png",4,"ngFor","ngForOf"],["src","../../../../assets/img/full-star.png",2,"height","30px","width","30px"],["type","text","placeholder","hipertension","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","controlada","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","migra\xf1a","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],["type","text","placeholder","grave","aria-label","Small","aria-describedby","inputGroup-sizing-sm",1,"form-control",3,"ngModel","ngModelChange"],[1,"mt-3","mb-5",2,"text-align","center"],[1,"btn","btn-lg","btn-success",3,"click"]],template:function(a,t){1&a&&(i.TgZ(0,"body")(1,"div",0),i._UZ(2,"app-navbar"),i.TgZ(3,"h3",1),i._uU(4,"Carga de Historia Clinica"),i.qZA(),i.TgZ(5,"div",2),i.YNc(6,y,8,3,"div",3),i.qZA(),i.TgZ(7,"div",4),i.YNc(8,M,10,3,"div",5),i.YNc(9,F,6,1,"div",6),i.qZA(),i._UZ(10,"hr"),i.TgZ(11,"div",7)(12,"h3",8),i._uU(13,"Datos Personales"),i.qZA(),i.TgZ(14,"p",9)(15,"b"),i._uU(16),i.qZA()()(),i.TgZ(17,"div",10)(18,"div",11)(19,"div",12)(20,"span",13)(21,"b"),i._uU(22,"Altura - cent\xedmetros: "),i.qZA()()(),i.TgZ(23,"input",14),i.NdJ("ngModelChange",function(s){return t.altura=s}),i.qZA(),i.TgZ(24,"div",12)(25,"span",13)(26,"b"),i._uU(27,"Peso - kilos: "),i.qZA()()(),i.TgZ(28,"input",15),i.NdJ("ngModelChange",function(s){return t.peso=s}),i.qZA()(),i.TgZ(29,"div",11)(30,"div",12)(31,"span",13)(32,"b"),i._uU(33,"Temperatura - grados: "),i.qZA()()(),i.TgZ(34,"input",16),i.NdJ("ngModelChange",function(s){return t.temperatura=s}),i.qZA(),i.TgZ(35,"div",12)(36,"span",13)(37,"b"),i._uU(38,"Presi\xf3n - XX/YY: "),i.qZA()()(),i.TgZ(39,"input",17),i.NdJ("ngModelChange",function(s){return t.presion=s}),i.qZA()()(),i._UZ(40,"hr"),i.TgZ(41,"div",7)(42,"h3",8),i._uU(43,"Ingreso de Historia clinica"),i.qZA(),i.TgZ(44,"button",18),i.NdJ("click",function(){return t.agregarCampo()}),i._uU(45,"+ Agregar Campo"),i.qZA(),i.TgZ(46,"button",19),i.NdJ("click",function(){return t.eliminarCampo()}),i._uU(47,"- Eliminar Campo"),i.qZA(),i.TgZ(48,"p",9)(49,"b"),i._uU(50),i.qZA()()(),i.TgZ(51,"div",20)(52,"div",11)(53,"div",12)(54,"span",13)(55,"b"),i._uU(56,"Dato"),i.qZA()()(),i.TgZ(57,"input",21),i.NdJ("ngModelChange",function(s){return t.datoUno=s}),i.qZA(),i.TgZ(58,"div",12)(59,"span",13)(60,"b"),i._uU(61,"Descripcion"),i.qZA()()(),i.TgZ(62,"input",22),i.NdJ("ngModelChange",function(s){return t.descUno=s}),i.qZA()()(),i.YNc(63,J,13,2,"div",23),i.YNc(64,D,13,2,"div",23),i.YNc(65,E,3,0,"div",24),i.qZA()()),2&a&&(i.xp6(6),i.Q6J("ngForOf",t.pacientesConImg),i.xp6(2),i.Q6J("ngIf",null!=t.pacienteSeleccionado),i.xp6(1),i.Q6J("ngIf",null!=t.calificacionesFiltradas&&t.calificacionesFiltradas.length>0),i.xp6(7),i.Oqu(t.mensajeError),i.xp6(7),i.Q6J("ngModel",t.altura),i.xp6(5),i.Q6J("ngModel",t.peso),i.xp6(6),i.Q6J("ngModel",t.temperatura),i.xp6(5),i.Q6J("ngModel",t.presion),i.xp6(5),i.Q6J("disabled",3===t.camposVisibles),i.xp6(2),i.Q6J("disabled",1===t.camposVisibles),i.xp6(4),i.Oqu(t.mensajeErrorHist),i.xp6(7),i.Q6J("ngModel",t.datoUno),i.xp6(5),i.Q6J("ngModel",t.descUno),i.xp6(1),i.Q6J("ngIf",t.camposVisibles>=2),i.xp6(1),i.Q6J("ngIf",t.camposVisibles>=3),i.xp6(1),i.Q6J("ngIf",null!=t.pacienteSeleccionado))},dependencies:[g.sg,g.O5,v.S,d.Fj,d.JJ,d.On],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]:before{content:"";position:fixed;top:0;left:0;width:100%;height:100%;background-image:url(back1.efcfdc6209eb7238.jpg);background-size:100%;opacity:.2;z-index:-1}body[_ngcontent-%COMP%]{background:none}']})}return o})()}];let q=(()=>{class o{static#i=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=i.oAB({type:o});static#t=this.\u0275inj=i.cJS({imports:[u.Bz.forChild(S),u.Bz]})}return o})();var f=r(5383);let N=(()=>{class o{static#i=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=i.oAB({type:o});static#t=this.\u0275inj=i.cJS({imports:[g.ez,q,f.W,d.u5,f.W]})}return o})()}}]);