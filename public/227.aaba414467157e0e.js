"use strict";(self.webpackChunkclinica=self.webpackChunkclinica||[]).push([[227],{4227:(j,h,l)=>{l.r(h),l.d(h,{MiPerfilModule:()=>N});var p=l(6814),g=l(1826),Z=l(3519),x=l.n(Z),T=l(217),i=l(5879),f=l(4108),U=l(6751),_=l(6700),d=l(95),A=l(7045);function C(o,r){if(1&o&&i._UZ(0,"img",20),2&o){const e=i.oxw(2);i.Q6J("src",e.imagenUrl,i.LSH)}}function D(o,r){if(1&o&&(i.TgZ(0,"p",11),i._uU(1),i.qZA()),2&o){const e=i.oxw(2);i.xp6(1),i.Oqu(e.usuarioBD.especialidad)}}function M(o,r){if(1&o&&(i.TgZ(0,"section")(1,"div",3)(2,"h2",4),i._uU(3,"Mi Perfil"),i.qZA(),i._UZ(4,"br")(5,"br"),i.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8),i.YNc(10,C,1,1,"img",9),i.TgZ(11,"h5",10),i._uU(12),i.qZA(),i.TgZ(13,"p",11),i._uU(14),i.qZA(),i.YNc(15,D,2,1,"p",12),i.qZA()()(),i.TgZ(16,"div",13)(17,"div",7)(18,"div",14)(19,"div",15)(20,"div",16)(21,"p",17),i._uU(22,"Nombre Completo"),i.qZA()(),i.TgZ(23,"div",18)(24,"p",19),i._uU(25),i.qZA()()(),i._UZ(26,"hr"),i.TgZ(27,"div",15)(28,"div",16)(29,"p",17),i._uU(30,"Email"),i.qZA()(),i.TgZ(31,"div",18)(32,"p",19),i._uU(33),i.qZA()()(),i._UZ(34,"hr"),i.TgZ(35,"div",15)(36,"div",16)(37,"p",17),i._uU(38,"Edad"),i.qZA()(),i.TgZ(39,"div",18)(40,"p",19),i._uU(41),i.qZA()()(),i._UZ(42,"hr"),i.TgZ(43,"div",15)(44,"div",16)(45,"p",17),i._uU(46,"Dni"),i.qZA()(),i.TgZ(47,"div",18)(48,"p",19),i._uU(49),i.qZA()()()()(),i._UZ(50,"div",15),i.qZA()()()()),2&o){const e=i.oxw();i.xp6(10),i.Q6J("ngIf",null!=e.imagenUrl),i.xp6(2),i.Oqu(e.usuarioBD.nombre),i.xp6(2),i.Oqu(e.usuarioBD.perfil),i.xp6(1),i.Q6J("ngIf","Especialista"==e.usuarioBD.perfil),i.xp6(10),i.AsE("",e.usuarioBD.nombre," ",e.usuarioBD.apellido,""),i.xp6(8),i.Oqu(e.usuarioBD.email),i.xp6(8),i.Oqu(e.usuarioBD.edad),i.xp6(8),i.Oqu(e.usuarioBD.dni)}}function B(o,r){if(1&o&&(i.TgZ(0,"p",4),i._uU(1),i.qZA()),2&o){const e=i.oxw(2);i.xp6(1),i.hij("Su especialidad: ",e.usuarioBD.especialidad,"")}}function q(o,r){if(1&o&&(i.TgZ(0,"option",33),i._uU(1),i.qZA()),2&o){const e=r.$implicit;i.Q6J("value",e),i.xp6(1),i.Oqu(e)}}function y(o,r){if(1&o&&(i.TgZ(0,"div")(1,"label",42),i._uU(2,"Horario Ingreso \xa0\xa0"),i.qZA(),i._UZ(3,"input",43)(4,"br")(5,"br"),i.TgZ(6,"label",42),i._uU(7,"Horario Egreso \xa0\xa0"),i.qZA(),i._UZ(8,"input",44),i.qZA()),2&o){const e=i.oxw().$implicit;i.xp6(1),i.MGl("for","inputIngreso_",e,""),i.xp6(2),i.MGl("id","inputIngreso_",e,""),i.xp6(3),i.MGl("for","inputEgreso_",e,""),i.xp6(2),i.MGl("id","inputEgreso_",e,"")}}function S(o,r){if(1&o){const e=i.EpF();i.TgZ(0,"div")(1,"div",39)(2,"input",40),i.NdJ("ngModelChange",function(t){const n=i.CHM(e).$implicit,c=i.oxw(3);return i.KtG(c.diasSeleccionados[n]=t)}),i.qZA(),i.TgZ(3,"label",41),i._uU(4,"\xa0\t\xa0"),i.TgZ(5,"b"),i._uU(6),i.qZA()()(),i._UZ(7,"br"),i.YNc(8,y,9,4,"div",1),i._UZ(9,"hr"),i.qZA()}if(2&o){const e=r.$implicit,s=r.index,t=i.oxw(3);i.xp6(2),i.Q6J("value",e)("id","checkDia"+s)("ngModel",t.diasSeleccionados[e]),i.xp6(4),i.Oqu(e),i.xp6(2),i.Q6J("ngIf",t.diasSeleccionados[e])}}function F(o,r){if(1&o){const e=i.EpF();i.TgZ(0,"div",34),i.YNc(1,S,10,5,"div",35),i.TgZ(2,"p",36)(3,"b"),i._uU(4),i.qZA()(),i.TgZ(5,"div",37)(6,"button",38),i.NdJ("click",function(){i.CHM(e);const t=i.oxw(2);return i.KtG(t.definirDisponibilidad())}),i._uU(7,"Aceptar"),i.qZA()()()}if(2&o){const e=i.oxw(2);i.xp6(1),i.Q6J("ngForOf",e.diasHabiles),i.xp6(3),i.Oqu(e.mensajeError)}}function E(o,r){if(1&o){const e=i.EpF();i.TgZ(0,"div",21)(1,"div",22)(2,"div",23)(3,"h5",24),i._uU(4,"Defina su Disponibilidad Horaria"),i.qZA(),i.TgZ(5,"div",25),i._UZ(6,"div",26),i.TgZ(7,"div",27)(8,"div",15)(9,"div"),i.YNc(10,B,2,1,"p",28),i.TgZ(11,"select",29),i.NdJ("change",function(t){i.CHM(e);const a=i.oxw();return i.KtG(a.seleccionarEspecialidad(t))}),i.TgZ(12,"option",30),i._uU(13,"Seleccione una Especialidad - sin disponibilidad definida"),i.qZA(),i.YNc(14,q,2,2,"option",31),i.qZA()()(),i._UZ(15,"hr"),i.YNc(16,F,8,2,"div",32),i.qZA(),i._UZ(17,"div",26),i.qZA(),i._UZ(18,"br")(19,"br"),i.qZA()()()}if(2&o){const e=i.oxw();i.xp6(10),i.Q6J("ngIf",null!=e.usuarioBD),i.xp6(4),i.Q6J("ngForOf",e.especialidadesSelect),i.xp6(2),i.Q6J("ngIf",e.mostrarForm)}}function I(o,r){if(1&o&&(i.TgZ(0,"li"),i._uU(1),i.qZA()),2&o){const e=r.$implicit;i.xp6(1),i.AsE(" ",e.dato," - ",e.descripcion," ")}}function P(o,r){if(1&o&&(i.TgZ(0,"div",59)(1,"div",60)(2,"h5",54),i._uU(3,"Historia Cl\xednica"),i.qZA(),i.TgZ(4,"div",55)(5,"ul",61)(6,"li"),i._uU(7),i.qZA(),i.TgZ(8,"li"),i._uU(9),i.qZA(),i.TgZ(10,"li"),i._uU(11),i.qZA(),i.TgZ(12,"li"),i._uU(13),i.qZA(),i.YNc(14,I,2,2,"li",35),i.qZA()()(),i._UZ(15,"br"),i.qZA()),2&o){const e=r.$implicit;i.xp6(7),i.hij("Altura: ",e.altura,""),i.xp6(2),i.hij("Peso: ",e.peso,""),i.xp6(2),i.hij("Presi\xf3n: ",e.presion,""),i.xp6(2),i.hij("Temperatura: ",e.temperatura,""),i.xp6(1),i.Q6J("ngForOf",e.detalles)}}function J(o,r){if(1&o){const e=i.EpF();i.TgZ(0,"div",62)(1,"input",63),i.NdJ("ngModelChange",function(t){i.CHM(e);const a=i.oxw(2);return i.KtG(a.especialistaSeleccionado=t)})("change",function(){i.CHM(e);const t=i.oxw(2);return i.KtG(t.obtenerInformacion(t.especialistaSeleccionado))}),i.qZA(),i._uU(2),i.qZA()}if(2&o){const e=r.$implicit,s=i.oxw(2);i.xp6(1),i.Q6J("value",e)("ngModel",s.especialistaSeleccionado),i.xp6(1),i.AsE(" ",e.nombre," ",e.apellido," ")}}function w(o,r){if(1&o){const e=i.EpF();i.TgZ(0,"div")(1,"div",45),i._UZ(2,"br"),i.TgZ(3,"h3",46)(4,"b"),i._uU(5,"Mis Historias Cl\xednicas"),i.qZA()(),i._UZ(6,"br"),i.TgZ(7,"div",47),i.YNc(8,P,16,5,"div",48),i.qZA()(),i.TgZ(9,"div",49)(10,"div",50),i._UZ(11,"div",51),i.TgZ(12,"div",52)(13,"div",53)(14,"h5",54),i._uU(15,"Seleccione una opci\xf3n y descargue las atenciones realizadas por el especialista elegido"),i.qZA(),i.TgZ(16,"div",55)(17,"p",56),i._uU(18,"Usted tiene turnos con los Especialistas:"),i.qZA(),i.YNc(19,J,3,4,"div",57),i.TgZ(20,"button",58),i.NdJ("click",function(){i.CHM(e);const t=i.oxw();return i.KtG(t.descargarTurnos())}),i._uU(21," Descargar Atenciones "),i.qZA()()()(),i._UZ(22,"div",51),i.qZA()()()}if(2&o){const e=i.oxw();i.xp6(8),i.Q6J("ngForOf",e.historiaClinica),i.xp6(11),i.Q6J("ngForOf",e.especialistasFiltrados),i.xp6(1),i.Q6J("disabled",void 0===e.especialistaSeleccionado)}}const O=[{path:"",component:(()=>{class o{constructor(e,s,t,a,n){this.router=e,this.authService=s,this.database=t,this.storageService=a,this.formBuilder=n,this.diasHabiles=["Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"],this.diasSeleccionados={},this.especialidadSeleccionada="",this.mostrarForm=!1,this.mensajeError="",this.usuarios=[],this.esPaciente=!1,this.turnos=[],this.turnosUsuarioActual=[],this.especialistasFiltrados=[],this.especialistas=[],this.informacion=[]}ngOnInit(){this.authService.getUserLogged().subscribe(e=>{if(e){this.usuarioLoggeado=e;const s=e.email;console.log("Email del usuario loggeado:",s),this.database.obtenerTodos("usuarios").subscribe(t=>{this.usuarios=t.map(a=>{let n=a.payload.doc.data();return n.id=a.payload.doc.id,n}),console.log(this.usuarios),this.especialistas=this.usuarios.filter(a=>"especialista"===a.perfil.toLowerCase()),console.log(this.especialistas),this.database.obtenerTodos("turnos").subscribe(a=>{if(this.turnos=a.map(n=>{let c=n.payload.doc.data();return c.id=n.payload.doc.id,c}),this.usuarioBD=this.usuarios.find(n=>n.email==s),console.log(this.usuarioBD),this.usuarioBD)if(console.log("Usuario encontrado en el array de usuarios:",this.usuarioBD),"paciente"==this.usuarioBD.perfil.toLowerCase())this.storageService.obtenerImagen("users",this.usuarioBD.imgPerfil[0]).then(c=>{this.imagenUrl=c,console.log(this.imagenUrl)}),this.esPaciente=!0,this.historiaClinica=this.usuarioBD.historiaClinica,console.log(this.historiaClinica),this.obtenerTurnosUsuarioActual();else if("administrador"==this.usuarioBD.perfil.toLowerCase())this.storageService.obtenerImagen("users",this.usuarioBD.imgPerfil).then(c=>{this.imagenUrl=c,console.log(this.imagenUrl)});else if("especialista"==this.usuarioBD.perfil.toLowerCase()){this.storageService.obtenerImagen("users",this.usuarioBD.imgPerfil).then(u=>{this.imagenUrl=u,console.log(this.imagenUrl)});const c=this.usuarioBD.especialidad;if(console.log(c),console.log(this.usuarioBD),!1!==this.usuarioBD.disponibilidad){const u=this.usuarioBD.disponibilidad.map(m=>m.especialidad),b=c.filter(m=>!u.includes(m));this.especialidadesSelect=b.length>0?b:[]}else this.especialidadesSelect=c,console.log(this.especialidadesSelect)}})})}})}seleccionarEspecialidad(e){this.especialidadSeleccionada=e.target.value,this.mostrarForm=!0}definirDisponibilidad(){let e=!0;const s={especialidad:this.especialidadSeleccionada,horarios:{}};for(const t in this.diasSeleccionados)if(e=!1,this.diasSeleccionados[t]){const a=document.getElementById(`inputIngreso_${t}`),n=document.getElementById(`inputEgreso_${t}`),c=+a.value,u=+n.value;if(console.log(u),console.log(c),""==a.value||""==n.value)return void(this.mensajeError=`Debe ingresar horarios para ${t}`);if(!(c>=8&&c<=19&&u>=8&&u<=19))return void(this.mensajeError="Los horarios ingresados no son v\xe1lidos");if("S\xe1bado"==t&&u>14)return void(this.mensajeError="El horario de egreso no puede ser mayor a 14 los s\xe1bados");s.horarios[t]={inicio:c,egreso:u}}e?this.mensajeError="Debe definir su disponibilidad":(this.usuarioBD.disponibilidad||(this.usuarioBD.disponibilidad=[]),this.usuarioBD.disponibilidad.push(s),this.database.actualizar("usuarios",this.usuarioBD,this.usuarioBD.id),console.log(this.usuarioBD),x().fire({title:"Disponibilidad Actualizada",confirmButtonColor:"#caff42",confirmButtonText:"Entendido"}).then(()=>{this.router.navigateByUrl("/home")}))}obtenerTurnosUsuarioActual(){this.turnosUsuarioActual=this.turnos.filter(e=>e.pacienteId===this.usuarioBD.id),this.especialistasFiltrados=[],this.especialistas.forEach(e=>{this.turnosUsuarioActual.filter(t=>t.especialistaId===e.id).length>0&&this.especialistasFiltrados.push(e)}),console.log(this.especialistasFiltrados),console.log(this.turnosUsuarioActual)}obtenerInformacion(e){this.informacion=[],this.especialistaSeleccionado=e,console.log(this.especialistaSeleccionado),this.turnosUsuarioActual.forEach(s=>{const t=this.especialistasFiltrados.find(a=>a.id===s.especialistaId);t.id==this.especialistaSeleccionado.id&&this.informacion.push({especialidad:s.especialidad,dia:s.dia,horario:s.horario,especialista:t.nombre+" "+t.apellido,estado:s.estado})}),console.log(this.informacion)}descargarTurnos(){const e=this.convertirTurnosAFormatoTexto();console.log(e);const s=new Blob([e],{type:"text/plain;charset=utf-8"});(0,T.saveAs)(s,this.usuarioBD.nombre+this.usuarioBD.apellido+"Turnos"+this.especialistaSeleccionado.nombre+this.especialistaSeleccionado.apellido+".txt")}convertirTurnosAFormatoTexto(){return this.informacion.map(e=>`${this.especialistaSeleccionado.nombre} ${this.especialistaSeleccionado.apellido}, ${e.especialidad}, ${e.dia}, ${e.horario} - ${e.estado}`).join("\n")}static#i=this.\u0275fac=function(s){return new(s||o)(i.Y36(g.F0),i.Y36(f.e),i.Y36(U.T),i.Y36(_.V),i.Y36(d.qu))};static#e=this.\u0275cmp=i.Xpm({type:o,selectors:[["app-mi-perfil"]],decls:6,vars:3,consts:[[1,"container"],[4,"ngIf"],["class","mt-4",4,"ngIf"],[1,"container","py-5"],[1,"text-center"],[1,"row",2,"background-color","#d0e0eb"],[1,"col-lg-4",2,"background-color","#b7d1e2"],[1,"card","mb-4","mt-4",2,"background-color","#d0e0eb"],[1,"card-body","text-center"],["alt","avatar","class","rounded-circle img-fluid","style","width: 150px;",3,"src",4,"ngIf"],[1,"my-3"],[1,"text-muted","mb-1"],["class","text-muted mb-1",4,"ngIf"],[1,"col-lg-8",2,"background-color","#b7d1e2"],[1,"card-body"],[1,"row"],[1,"col-sm-3"],[1,"mb-0"],[1,"col-sm-9"],[1,"text-muted","mb-0"],["alt","avatar",1,"rounded-circle","img-fluid",2,"width","150px",3,"src"],[1,"mt-4"],[1,"card"],[1,"card-body",2,"background-color","#d0e0eb"],[1,"card-title","text-center"],[1,"input-group","mb-3"],[1,"col"],[1,"col-6"],["class","text-center",4,"ngIf"],["name","especialidad","id","",1,"form-select",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["class","form-check","style","align-items: center; justify-content: center;",4,"ngIf"],[3,"value"],[1,"form-check",2,"align-items","center","justify-content","center"],[4,"ngFor","ngForOf"],[1,"text-danger"],[2,"text-align","center"],[1,"btn","mt-4","text-center","btn-lg",2,"background-color","#caff42",3,"click"],[1,"d-flex","align-items-center"],["type","checkbox","name","diasSeleccionados",1,"form-check-input",3,"value","id","ngModel","ngModelChange"],["for","'checkDia' + i",1,"form-check-label"],[3,"for"],["type","number","min","8","max","19","width","50",1,"form-control",2,"background-color","#bbc8d0",3,"id"],["type","number","min","8","max","19",1,"form-control",2,"background-color","#bbc8d0",3,"id"],[1,"",2,"background-color","#90b9d5","text-align","center"],[1,"text-center","text-primary"],[1,"row","justify-content-center"],["class","col-4",4,"ngFor","ngForOf"],[2,"background-color","#64a5d0"],[1,"row","my-4"],[1,"col-2"],[1,"col-8","text-center"],[1,"card","mx-3","my-3"],[1,"card-header",2,"background-color","#397c9e"],[1,"card-body",2,"background-color","#eee"],[1,"text-muted"],["class","radio-buttons-container mb-1",4,"ngFor","ngForOf"],[1,"btn","btn-md","btn-primary","my-3",3,"disabled","click"],[1,"col-4"],[1,"card","my-2","mx-2"],[1,"card-text","text-start"],[1,"radio-buttons-container","mb-1"],["type","radio","ngDefaultControl","","name","especialistaRadio",3,"value","ngModel","ngModelChange","change"]],template:function(s,t){1&s&&(i.TgZ(0,"body")(1,"div",0),i._UZ(2,"app-navbar"),i.YNc(3,M,51,9,"section",1),i.YNc(4,E,20,3,"div",2),i.YNc(5,w,23,3,"div",1),i.qZA()()),2&s&&(i.xp6(3),i.Q6J("ngIf",null!=t.usuarioBD),i.xp6(1),i.Q6J("ngIf",null!=t.usuarioBD&&"Especialista"==t.usuarioBD.perfil),i.xp6(1),i.Q6J("ngIf",t.esPaciente))},dependencies:[p.sg,p.O5,d.YN,d.Kr,d.Fj,d.Wl,d._,d.JJ,d.On,A.S],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]:before{content:"";position:fixed;top:0;left:0;width:100%;height:100%;background-image:url(back3.0785549b999bc1f3.jpg);background-size:100%;opacity:.6;z-index:-1}body[_ngcontent-%COMP%]{background:none}']})}return o})()}];let k=(()=>{class o{static#i=this.\u0275fac=function(s){return new(s||o)};static#e=this.\u0275mod=i.oAB({type:o});static#o=this.\u0275inj=i.cJS({imports:[g.Bz.forChild(O),g.Bz]})}return o})();var v=l(5383);let N=(()=>{class o{static#i=this.\u0275fac=function(s){return new(s||o)};static#e=this.\u0275mod=i.oAB({type:o});static#o=this.\u0275inj=i.cJS({providers:[_.V,f.e],imports:[p.ez,k,d.u5,v.W,v.W]})}return o})()}}]);